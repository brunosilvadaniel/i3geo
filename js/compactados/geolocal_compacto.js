if(typeof(i3GEO)==='undefined'){var i3GEO={}}i3GEO.geolocal={_timer:"",_delay:500,_pin:"",_snackbar:"",start:function(){if(i3GEO.geolocal._timer!=""){i3GEO.geolocal.stop()}else{var html="<div class='text-center'> Geolocal. "+$trad("clickparar")+"</div><div id='geolocalresults' class='text-center'></div>";i3GEO.geolocal._snackbar=i3GEO.janela.snackBar({content:html,onClose:function(){i3GEO.geolocal.stop()},timeout:0});i3GEO.geolocal.firstPoint()}},firstPoint:function(){var retorno=function(position){i3GEO.geolocal.showPoint(position);i3GEO.geolocal.createTimer()};navigator.geolocation.getCurrentPosition(retorno,i3GEO.geolocal.erro)},createTimer:function(){i3GEO.geolocal._timer=setInterval(function(){i3GEO.geolocal.movePoint()},i3GEO.geolocal._delay)},stop:function(){clearInterval(i3GEO.geolocal._timer);i3GEO.geolocal._timer="";i3GEO.geolocal.removePoint();$(i3GEO.geolocal._snackbar).snackbar("hide");i3GEO.geolocal._snackbar=""},showPoint:function(position){var y=position.coords.latitude;var x=position.coords.longitude;i3GEO.navega.pan2ponto(x,y);i3GEO.geolocal._pin=i3GEO.desenho.addPin({x:x,y:y,namespace:"pingeolocal"});$("#geolocalresults").html("lat: "+y+" lon: "+x)},movePoint:function(position){var retorno=function(position){var y=position.coords.latitude;var x=position.coords.longitude;i3GEO.geolocal.center(x,y);i3GEO.desenho.movePin(i3GEO.geolocal._pin,x,y)};navigator.geolocation.getCurrentPosition(retorno,i3GEO.geolocal.erro)},center:function(x,y){var point=i3GEO.util.extGeo2OSM(new ol.geom.Point([x,y]));if(i3geoOL.getExtent().getGeometry().intersectsCoordinate(point.getCoordinates())==false){i3GEO.navega.pan2ponto(x,y)}},removePoint:function(){i3GEO.desenho.removePins("pingeolocal")},erro:function(error){i3GEO.geolocal.stop();var erro="";switch(error.code){case error.PERMISSION_DENIED:erro="User denied the request for Geolocation.";break;case error.POSITION_UNAVAILABLE:erro="Location information is unavailable.";break;case error.TIMEOUT:erro="The request to get user location timed out.";break;case error.UNKNOWN_ERROR:erro="An unknown error occurred.";break}i3GEO.janela.snackBar({content:erro,style:"red"})}}