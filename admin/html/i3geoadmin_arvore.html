<html>
<head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<link rel="stylesheet" type="text/css" href="admin.css">
<script src="../../pacotes/cpaint/cpaint2.inc.compressed.js" type="text/javascript"></script>
<script src="../js/admin.js" type="text/javascript"></script>
<script src="../js/arvore.js" type="text/javascript"></script>
</head>
<body>
<div style=width:80%;text-align:center;>
<h1>Administração do i3geo - menu de temas</h1>
<p><a href="../index.html">Voltar</a></p>
<p>Este programa permite editar as árvores de cada menu</p>
<p>O menu é baseado no banco admin.db.</p>
<p>A lista de IPs dos usuários que podem editar os arquivos de configuração do i3geo e 
dos que podem navegar pelos diretórios do servidor, não são mostradas aqui. Para 
alterar essas variáveis, vc deve editar diretamente o arquivo i3geo/ms_configura.php.</p>
<p>Utilize as opções abaixo para relacionar os temas a grupos e sub-grupos. Escolha primeiro um menu e depois edite 
os grupos, adicionando temas ou sub-grupos. A estrutura é hierárquica e permite que temas sejam criados também na raiz de um grupo ou do próprio menu. 
<p>Os grupos, sub-grupos e temas já devem ter sido criados para que se possa montar a árvore de associações.
</div>
<div id=aguarde style="color:red" ><p>Aguarde...</p></div>
</body>
<script>
/*
Title: Administração da árvore de menus

File: i3geo/admin/i3geoadmin_arvore.htm
*/
$parametros = {
	"simples": [
	{ mensagem: "Edição das árvores dos menus",cabeca: "Raiz",variavel:"arvores"}
	]};

var iniciaMenu = function(retorno)
{
	pegaParametros()	
	iniciaAdmin()
	if(retorno.data == "" || retorno.data.length == 0)
	{document.body.innerHTML += "Nenhum menu cadastrado."}
	else
	{
		var ins = "<p><b>Selecione o menu:</b> "
		ins += "<select id=menusel onchange='pegaParametros();listaRaiz()' >"
		ins += "<option value='' >---</option>"
		for(var i = 0;i < retorno.data.length;i++)
		{
			ins += "<option value='"+retorno.data[i].id_menu+"' >"+retorno.data[i].nome_menu+"</option>"
		}
		ins += "</select><hr>"
		document.body.innerHTML += ins;
	}
}
var cp = new cpaint();
//cp.set_async(false);
cp.set_response_type("JSON");
//pega os menus
var p = "../php/menutemas.php?funcao=pegaMenus";
cp.call(p,"pegaMenus",iniciaMenu);
//pega os grupos e subgrupos

grupos = function(retorno){$grupos = retorno.data;}
subGrupos = function(retorno){$subGrupos = retorno.data;};
temas = function(retorno){$temas = retorno.data;}
temasRaiz = function(retorno){$temasRaiz = retorno.data;}

function pegaParametros()
{
	var cp = new cpaint();
	//cp.set_async(false);
	cp.set_response_type("JSON");
	var p = "../php/menutemas.php?funcao=pegaGrupos";
	cp.call(p,"pegaMenus",grupos);

	var p = "../php/menutemas.php?funcao=pegaSubGrupos";
	cp.call(p,"pegaMenus",subGrupos);

	var p = "../php/menutemas.php?funcao=pegaTemas";
	cp.call(p,"pegaMenus",temas);

	var p = "../php/arvore.php?funcao=pegaTemasRaiz";
	cp.call(p,"pegaMenus",temasRaiz);
}

document.getElementById("aguarde").style.display="none"
</script>
</html>