<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: Fitted Conditional Intensity for Point Process Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for fitted.ppm {spatstat}"><tr><td>fitted.ppm {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Fitted Conditional Intensity for Point Process Model</h2>


<h3>Description</h3>

<p>
Given a point process model fitted to a point pattern,
compute the fitted conditional intensity of the model
at the points of the pattern,
or at the points of the quadrature scheme used to fit the model.
</p>


<h3>Usage</h3>

<pre>
  ## S3 method for class 'ppm':
  fitted(object, ..., type="lambda", dataonly=FALSE,
check=TRUE, repair=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
The fitted point process model (an object of class <code>"ppm"</code>)
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Ignored.
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
String (partially matched) indicating whether the fitted value is the
conditional intensity (<code>"lambda"</code>) or the trend
(<code>"trend"</code>).
</td></tr>
<tr valign="top"><td><code>dataonly</code></td>
<td>
Logical. If <code>TRUE</code>, then values will only be computed
at the points of the data point pattern. If <code>FALSE</code>, then
values will be computed at all the points of the quadrature scheme
used to fit the model, including the points of the data point pattern.
</td></tr>
<tr valign="top"><td><code>check</code></td>
<td>
Logical value indicating whether to check the internal format
of <code>object</code>. If there is any possibility that this object
has been restored from a dump file, or has otherwise lost track of
the environment where it was originally computed, set
<code>check=TRUE</code>. 
</td></tr>
<tr valign="top"><td><code>repair</code></td>
<td>
Logical value indicating whether to repair the internal format
of <code>object</code>, if it is found to be damaged. 
</td></tr>
</table>

<h3>Details</h3>

<p>
The argument <code>object</code> must be a fitted point process model
(object of class <code>"ppm"</code>). Such objects are produced by the 
model-fitting algorithm <code><a href="ppm.html">ppm</a></code>).
</p>
<p>
This function evaluates the conditional intensity
<i>lambdahat(u,x)</i>
or spatial trend <i>bhat(u)</i> of the fitted point process
model for certain locations <i>u</i>,
where <code>x</code> is the original point pattern dataset to which
the model was fitted.
</p>
<p>
The locations <i>u</i> at which the fitted conditional intensity/trend
is evaluated, are the points of the
quadrature scheme used to fit the model in <code><a href="ppm.html">ppm</a></code>.
They include the data points (the points of the original point pattern
dataset <code>x</code>) and other ``dummy'' points 
in the window of observation.
</p>
<p>
Use <code><a href="predict.ppm.html">predict.ppm</a></code> to compute the fitted conditional
intensity at other locations or with other values of the
explanatory variables.
</p>


<h3>Value</h3>

<p>
A vector containing the values of the fitted conditional intensity
or (if <code>type="trend"</code>) the fitted spatial trend.
<br>
Entries in this vector correspond to the quadrature points (data or
dummy points) used to fit the model. The quadrature points can be
extracted from <code>object</code> by <code>union.quad(quad.ppm(object))</code>.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Baddeley, A., Turner, R., Moller, J. and Hazelton, M. (2005).
Residual analysis for spatial point processes (with discussion).
<EM>Journal of the Royal Statistical Society, Series B</EM>
<B>67</B>, 617&ndash;666.
</p>


<h3>See Also</h3>

<p>
<code><a href="ppm.object.html">ppm.object</a></code>,
<code><a href="ppm.html">ppm</a></code>,
<code><a href="predict.ppm.html">predict.ppm</a></code>
</p>


<h3>Examples</h3>

<pre>
    data(cells)
    str &lt;- ppm(cells, ~x, Strauss(r=0.15), rbord=0.15)
    lambda &lt;- fitted(str)

    # extract quadrature points in corresponding order
    quadpoints &lt;- union.quad(quad.ppm(str))

    # plot conditional intensity values
    # as circles centred on the quadrature points 
    quadmarked &lt;- setmarks(quadpoints, lambda)
    plot(quadmarked)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
