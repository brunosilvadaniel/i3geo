<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: plot a Spatial Point Pattern</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for plot.ppp {spatstat}"><tr><td>plot.ppp {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>plot a Spatial Point Pattern</h2>


<h3>Description</h3>

<p>
Plot a two-dimensional spatial point pattern
</p>


<h3>Usage</h3>

<pre>
 ## S3 method for class 'ppp':
 plot(x, main, ..., chars, cols, use.marks=TRUE, add=FALSE,
maxsize, markscale)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
The spatial point pattern to be plotted.
An object of class <code>"ppp"</code>,
or data which can be converted into 
this format by <code><a href="as.ppp.html">as.ppp</a>()</code>.
</td></tr>
<tr valign="top"><td><code>main</code></td>
<td>
text to be displayed as a title above the plot.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
extra arguments that will be passed to the plotting functions
<code><a href="../../graphics/html/plotdefault.html">plot.default</a></code>, <code><a href="../../graphics/html/points.html">points</a></code> and/or
<code><a href="../../graphics/html/symbols.html">symbols</a></code>.
</td></tr>
<tr valign="top"><td><code>chars</code></td>
<td>
plotting character(s) used to plot points.
</td></tr>
<tr valign="top"><td><code>cols</code></td>
<td>
the colour(s) used to plot points.
</td></tr>
<tr valign="top"><td><code>use.marks</code></td>
<td>
logical flag; if <code>TRUE</code>, plot points using a different
plotting symbol for each mark;
if <code>FALSE</code>, only the locations of the points will be plotted,
using <code><a href="../../graphics/html/points.html">points</a>()</code>.
</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>
logical flag; if <code>TRUE</code>,
just the points are plotted, over the existing plot.
A new plot is not created, and
the window is not plotted.
</td></tr>
<tr valign="top"><td><code>maxsize</code></td>
<td>
maximum size of the circles/squares plotted
when <code>x</code> is a marked point pattern with 
numerical marks.
Incompatible with <code>markscale</code>.
</td></tr>
<tr valign="top"><td><code>markscale</code></td>
<td>
physical scale factor determining the sizes of the
circles/squares plotted when <code>x</code> is a marked point pattern with 
numerical marks. Incompatible with <code>maxsize</code>.
</td></tr>
</table>

<h3>Details</h3>

<p>
This is the <code>plot</code> method for 
point pattern datasets (of class <code>"ppp"</code>, see <code><a href="ppp.object.html">ppp.object</a></code>).
</p>
<p>
First the observation window <code>x$window</code> is plotted.
Then the points themselves are plotted,
in a fashion that depends on their marks,
as follows.
<dl>
<dt>unmarked point pattern:</dt><dd>If the point pattern does not have marks, or if <code>use.marks = FALSE</code>,
then the locations of all points will be plotted 
using a single plot character
</dd>
<dt>multitype point pattern:</dt><dd>If <code>x$marks</code> is a factor, then 
each level of the factor is 
represented by a different plot character.
</dd>
<dt>continuous marks:</dt><dd>If <code>x$marks</code> is a numeric vector,
the marks are rescaled to the unit interval and
each point is represented by a circle 
with radius proportional to the rescaled mark
(if the value is positive) or a square with side proportional
to the absolute value of the rescaled mark (if the value is negative).
</dd>
<dt>other kinds of marks:</dt><dd>If <code>x$marks</code> is neither numeric nor a factor,
then each possible mark will be represented by a
different plotting character. The default is to
represent the <i>i</i>th smallest mark value by
<code>points(..., pch=i)</code>.
</dd>
</dl>

<p>
Plotting of the window <code>x$window</code> is performed by
<code><a href="plot.owin.html">plot.owin</a></code>. This plot may be modified 
through the <code>...</code> arguments. In particular the
extra argument <code>col</code> determines the colour of the window.
</p>
<p>
Plotting of the points themselves is performed
by the function <code><a href="../../graphics/html/points.html">points</a></code>, except for the case of
continuous marks, where it is performed by <code><a href="../../graphics/html/symbols.html">symbols</a></code>.
Their plotting behaviour may be modified through the <code>...</code>
arguments.
</p>
<p>
The argument <code>chars</code> determines the plotting character
or characters used to display the points (in all cases except
for the case of continuous marks). For an unmarked point pattern,
this should be a single integer or character determining a
plotting character (see <code>par("pch")</code>).
For a multitype point pattern, <code>chars</code> should be a vector
of integers or characters, of the same length
as <code>levels(x$marks)</code>, and then the <i>i</i>th level or type 
will be plotted using character <code>chars[i]</code>.
</p>
<p>
If <code>chars</code> is absent, but there is an extra argument
<code>pch</code>, then this will determine the plotting character for
all points.
</p>
<p>
The argument <code>cols</code> determines the colour or colours used to
display the points. For an unmarked point pattern, or a
marked point pattern with continuous marks, this should be a character string
determining a colour. For a multitype point pattern, <code>cols</code>
should be a character vector, of the same length
as <code>levels(x$marks)</code>. The <i>i</i>th level or type will
be plotted using colour <code>cols[i]</code>.
</p>
<p>
If <code>cols</code> is absent, the colour used to plot <EM>all</EM> the
points may be determined by the extra argument <code>fg</code>
(for multitype point patterns) or the extra argument <code>col</code>
(for all other cases). Note that <code>col</code> will also reset the
colour of the window.
</p>
<p>
The arguments <code>maxsize</code> and <code>markscale</code> 
incompatible. They control the physical size of the circles and
squares which represent the marks in a point pattern with continuous
marks. If <code>markscale</code> is given, then a mark value of <code>m</code>
is plotted as a circle of radius <code>m * markscale</code>
(if <code>m</code> is positive) or a square of side <code>abs(m) * markscale</code>
(if <code>m</code> is negative). If <code>maxsize</code> is given, then the
largest mark in absolute value, <code>mmax=max(abs(x$marks))</code>,
will be scaled to have physical size <code>maxsize</code>.
</p>
<p>
The user can set the default values of these plotting parameters
using <code><a href="spatstat.options.html">spatstat.options</a>("par.points")</code>.
</p>
<p>
The value returned by this plot function can be used to make a
suitable legend, as shown in the examples.
</p>


<h3>Value</h3>

<p>
<code>NULL</code>, or a vector giving the correspondence between 
mark values and plotting characters.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="ppp.object.html">ppp.object</a></code>,
<code><a href="../../Zelig/html/plot.zelig.html">plot</a></code>,
<code><a href="../../graphics/html/par.html">par</a></code>,
<code><a href="../../graphics/html/points.html">points</a></code>,
<code><a href="plot.owin.html">plot.owin</a></code>,
<code><a href="../../graphics/html/symbols.html">symbols</a></code>
</p>


<h3>Examples</h3>

<pre>
   data(cells)
   plot(cells)

   plot(cells, pch=16)

   # make the plotting symbols larger (for publication at reduced scale)
   plot(cells, cex=2)

   # set it in spatstat.options
   oldopt &lt;- spatstat.options(par.points=list(cex=2))
   plot(cells)
   spatstat.options(oldopt)

   # multitype 
   data(lansing)
   plot(lansing)

   # marked by a real number
   data(longleaf)
   plot(longleaf)

   # just plot the points
   plot(longleaf, use.marks=FALSE)
   plot(unmark(longleaf)) # equivalent

   # controlling COLOURS of points
   plot(cells, cols="blue")
   plot(lansing, cols=c("black", "yellow", "green", 
                        "blue","red","pink"))
   plot(longleaf, fg="blue")

   # make points and window purple
   plot(lansing, col="purple")
   # make everything purple
   plot(lansing, col="purple", col.main="purple")
 
   # controlling PLOT CHARACTERS
   plot(lansing, chars = 11:16)
   plot(lansing, chars = c("o","h","m",".","o","o"))

   # controlling MARK SCALE
   plot(longleaf, markscale=0.1)

   # draw circles of diameter equal to nearest neighbour distance
   plot(cells %mark% (nndist(cells)/2), markscale=1)

   # making the legend
   data(amacrine)
   v &lt;- plot(amacrine)
   legend(0.2, 1.2, pch=v, legend=names(v))
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
