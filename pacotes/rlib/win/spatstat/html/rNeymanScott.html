<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Simulate Neyman-Scott Process</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rNeymanScott {spatstat}"><tr><td>rNeymanScott {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Simulate Neyman-Scott Process</h2>


<h3>Description</h3>

<p>
Generate a random point pattern, a realisation of the
Neyman-Scott cluster process.
</p>


<h3>Usage</h3>

<pre>
 rNeymanScott(kappa, rmax, rcluster, win = owin(c(0,1),c(0,1)), ..., lmax=NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>kappa</code></td>
<td>
Intensity of the Poisson process of cluster centres.
A single positive number, a function, or a pixel image.
</td></tr>
<tr valign="top"><td><code>rmax</code></td>
<td>
Maximum radius of a random cluster.
</td></tr>
<tr valign="top"><td><code>rcluster</code></td>
<td>
A function which generates random clusters.
</td></tr>
<tr valign="top"><td><code>win</code></td>
<td>
Window in which to simulate the pattern.
An object of class <code>"owin"</code>
or something acceptable to <code><a href="as.owin.html">as.owin</a></code>.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Arguments passed to <code>rcluster</code>
</td></tr>
<tr valign="top"><td><code>lmax</code></td>
<td>
Optional. Upper bound on the values of <code>kappa</code>
when <code>kappa</code> is a function or pixel image.
</td></tr>
</table>

<h3>Details</h3>

<p>
This algorithm generates a realisation of the
general Neyman-Scott process, with the cluster mechanism
given by the function <code>rcluster</code>. 
The clusters must have a finite maximum possible radius <code>rmax</code>.
</p>
<p>
First, the algorithm
generates a Poisson point process of ``parent'' points 
with intensity <code>kappa</code>. Here <code>kappa</code> may be a single
positive number, a function <code>kappa(x, y)</code>, or a pixel image
object of class <code>"im"</code> (see <code><a href="im.object.html">im.object</a></code>).
See <code><a href="rpoispp.html">rpoispp</a></code> for details.
</p>
<p>
Second, each parent point is
replaced by a random cluster of points, created by calling the
function <code>rcluster</code>.
These clusters are combined together to yield a single point pattern
which is then returned as the result of <code>rNeymanScott</code>.
</p>
<p>
The function <code>rcluster</code> should expect to be called as
<code>rcluster(xp[i],yp[i],...)</code> for each parent point at a location
<code>(xp[i],yp[i])</code>. The return value of <code>rcluster</code>
should be a list with elements
<code>x,y</code> which are vectors of equal length giving the absolute
<i>x</i> and <code>y</code> coordinates of the points in the cluster.
</p>
<p>
If required, the intermediate stages of the simulation (the parents
and the individual clusters) can also be extracted from
the return value of <code>rNeymanScott</code>
through the attributes <code>"parents"</code> and <code>"parentid"</code>.
The attribute <code>"parents"</code> is the point pattern of parent points.
The attribute <code>"parentid"</code> is an integer vector specifying
the parent for each of the points in the simulated pattern.
</p>


<h3>Value</h3>

<p>
The simulated point pattern (an object of class <code>"ppp"</code>).
<br>
Additionally,  some intermediate results of the simulation are
returned as attributes of this point pattern: see Details.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="rpoispp.html">rpoispp</a></code>,
<code><a href="rThomas.html">rThomas</a></code>,
<code><a href="rMatClust.html">rMatClust</a></code>
</p>


<h3>Examples</h3>

<pre>
  nclust &lt;-  function(x0, y0, radius, n) {
                           return(runifdisc(n, radius, centre=c(x0, y0)))
                         }
  X &lt;- rNeymanScott(10, 0.2, nclust, radius=0.2, n=5)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
