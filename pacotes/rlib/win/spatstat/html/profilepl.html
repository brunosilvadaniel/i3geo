<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: Profile Maximum Pseudolikelihood</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for profilepl {spatstat}"><tr><td>profilepl {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Profile Maximum Pseudolikelihood</h2>


<h3>Description</h3>

<p>
Fits point process models by profile maximum pseudolikelihood
</p>


<h3>Usage</h3>

<pre>
profilepl(s, f, ..., rbord = NULL, verbose = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
Data frame containing values of the irregular parameters
over which the profile pseudolikelihood will be computed.
</td></tr>
<tr valign="top"><td><code>f</code></td>
<td>
Function (such as <code><a href="Strauss.html">Strauss</a></code>)
that generates an interpoint interaction object, given
the values of the irregular parameters.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Data passed to <code><a href="ppm.html">ppm</a></code> to fit the model.
</td></tr>
<tr valign="top"><td><code>rbord</code></td>
<td>
Radius for border correction (same for all models).
If omitted, this will be computed from the interactions.
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
Logical flag indicating whether to print progress reports.
</td></tr>
</table>

<h3>Details</h3>

<p>
The model-fitting function <code><a href="ppm.html">ppm</a></code> fits point process
models to point pattern data. However, 
only the &lsquo;regular&rsquo; parameters of the model can be fitted by
<code><a href="ppm.html">ppm</a></code>. The model may also depend on &lsquo;irregular&rsquo;
parameters that must be fixed in any call to <code><a href="ppm.html">ppm</a></code>.
</p>
<p>
This function <code>profilepl</code> is a wrapper which finds the values of the
irregular parameters that give the best fit. It uses the method of
maximum profile pseudolikelihood. 
</p>
<p>
The argument <code>f</code> would typically be one of the functions
<code><a href="Strauss.html">Strauss</a></code>,
<code><a href="StraussHard.html">StraussHard</a></code>,
<code><a href="Softcore.html">Softcore</a></code>,
<code><a href="DiggleGratton.html">DiggleGratton</a></code>,
<code><a href="Geyer.html">Geyer</a></code>,
<code><a href="LennardJones.html">LennardJones</a></code>
or <code><a href="OrdThresh.html">OrdThresh</a></code>.
For the moment, assume this is so.
</p>
<p>
The argument <code>s</code> must be a data frame whose columns contain
values of the irregular parameters. The names of the columns of
<code>s</code> must match the argument names of <code>f</code>.
</p>
<p>
To apply the method of profile maximum pseudolikelihood,
each row of <code>s</code> will be taken in turn; the parameter values in this row
will be passed to <code>f</code>, resulting in an interaction object.
Then <code><a href="ppm.html">ppm</a></code> will be applied to the data <code>...</code>
using this interaction; this results in a fitted point process model.
The value of the log pseudolikelihood from this model is stored.
After all rows of <code>s</code> have been processed in this way, the
row giving the maximum value of log pseudolikelihood will be found.
</p>
<p>
The object returned by <code>profilepl</code> contains the profile
pseudolikelihood function, the best fitting model, and other data.
It can be plotted (yielding a
plot of the log pseudolikelihood values against the irregular
parameters) or printed (yielding information about the best fitting
values of the irregular parameters). 
</p>
<p>
In general, <code>f</code> may be any function that will return
an interaction object (object of class <code>"interact"</code>)
that can be used in a call to <code><a href="ppm.html">ppm</a></code>. Each argument of
<code>f</code> must be a single value.
</p>


<h3>Value</h3>

<p>
An object of class <code>"profilepl"</code>. There are methods
for <code><a href="../../Zelig/html/plot.zelig.html">plot</a></code> and <code><a href="../../stam/html/stam-internal.html">print</a></code> for this class.
<br>
The components of the object include
</p>
<table summary="R argblock">
<tr valign="top"><td><code>fit</code></td>
<td>
Best-fitting model</td></tr>
<tr valign="top"><td><code>param</code></td>
<td>
The data frame <code>s</code></td></tr>
</table>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>Examples</h3>

<pre>
    data(cells)

    # one irregular parameter
    s &lt;- data.frame(r=seq(0.05,0.15, by=0.01))
    
    ps &lt;- profilepl(s, Strauss, cells)
    ps
    plot(ps)

    # two irregular parameters
    s &lt;- expand.grid(r=seq(0.05,0.15, by=0.01),sat=1:3)
    
    pg &lt;- profilepl(s, Geyer, cells)
    pg
    plot(pg)
    ## Not run: 
    pg$fit
    
## End(Not run)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
