<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Exponential Energy Marks</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for eem {spatstat}"><tr><td>eem {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Exponential Energy Marks</h2>


<h3>Description</h3>

<p>
Given a point process model fitted to a point pattern,
compute the Stoyan-Grabarnik diagnostic ``exponential energy marks''
for the data points.
</p>


<h3>Usage</h3>

<pre>
  eem(fit, check=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>fit</code></td>
<td>
The fitted point process model. An object of class <code>"ppm"</code>.
</td></tr>
<tr valign="top"><td><code>check</code></td>
<td>
Logical value indicating whether to check the internal format
of <code>fit</code>. If there is any possibility that this object
has been restored from a dump file, or has otherwise lost track of
the environment where it was originally computed, set
<code>check=TRUE</code>. 
</td></tr>
</table>

<h3>Details</h3>

<p>
Stoyan and Grabarnik (1991) proposed a diagnostic
tool for point process models fitted to spatial point pattern data.
Each point <i>x_i</i> of the data pattern <i>X</i>
is given a `mark' or `weight'
</p><p align="center"><i>m_i = frac 1 {hat&lambda;(x_i,X)}</i></p><p>
where <i>hat&lambda;(x_i,X)</i>
is the conditional intensity of the fitted model.
If the fitted model is correct, then the sum of these marks
for all points in a region <i>B</i> has expected value equal to the
area of <i>B</i>.
</p>
<p>
The argument <code>fit</code> must be a fitted point process model
(object of class <code>"ppm"</code>). Such objects are produced by the maximum
pseudolikelihood fitting algorithm <code><a href="ppm.html">ppm</a></code>).
This fitted model object contains complete
information about the original data pattern and the model that was
fitted to it.
</p>
<p>
The value returned by <code>eem</code> is the vector
of weights <i>m_i</i> associated with the points <i>x_i</i>
of the original data pattern. The original data pattern
(in corresponding order) can be
extracted from <code>fit</code> using <code><a href="data.ppm.html">data.ppm</a></code>.
</p>
<p>
The function <code><a href="diagnose.ppm.html">diagnose.ppm</a></code>
produces a set of sensible diagnostic plots based on these weights.
</p>


<h3>Value</h3>

<p>
A vector containing the values of the exponential energy mark
for each point in the pattern.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Stoyan, D. and Grabarnik, P. (1991)
Second-order characteristics for stochastic structures connected with
Gibbs point processes.
<EM>Mathematische Nachrichten</EM>, 151:95&ndash;100.
</p>


<h3>See Also</h3>

<p>
<code><a href="diagnose.ppm.html">diagnose.ppm</a></code>,
<code><a href="ppm.object.html">ppm.object</a></code>,
<code><a href="data.ppm.html">data.ppm</a></code>,
<code><a href="residuals.ppm.html">residuals.ppm</a></code>,
<code><a href="ppm.html">ppm</a></code>
</p>


<h3>Examples</h3>

<pre>
    data(cells)
    fit &lt;- ppm(cells, ~x, Strauss(r=0.15), rbord=0.15)
    ee &lt;- eem(fit)
    sum(ee)/area.owin(cells$window) # should be about 1 if model is correct
    Y &lt;- setmarks(cells, ee)
    plot(Y, main="Cells data\n Exponential energy marks")
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
