<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Test Whether Points Are Inside A Window</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for inside.owin {spatstat}"><tr><td>inside.owin {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Test Whether Points Are Inside A Window</h2>


<h3>Description</h3>

<p>
Test whether points lie inside or outside
a given window.
</p>


<h3>Usage</h3>

<pre>
 inside.owin(x, y, w)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
Vector of <i>x</i> coordinates of points to be tested.
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
Vector of <i>y</i> coordinates of points to be tested.
</td></tr>
<tr valign="top"><td><code>w</code></td>
<td>
A window.
This should be an object of class <code><a href="owin.html">owin</a></code>,
or can be given in any format acceptable to <code><a href="as.owin.html">as.owin</a>()</code>.
</td></tr>
</table>

<h3>Details</h3>

<p>
This function tests whether each of the points 
<code>(x[i],y[i])</code> lies inside or outside
the window <code>w</code> and returns <code>TRUE</code> if it is inside.
</p>
<p>
The boundary of the window is treated as being inside.
</p>
<p>
If <code>w</code> is of type <code>"rectangle"</code> or 
<code>"polygonal"</code>, the algorithm uses analytic geometry
(the discrete Stokes theorem).
Computation time is linear in the number of points
and (for polygonal windows) in the number of vertices of the
boundary polygon. Boundary cases are correct to single
precision accuracy.
</p>
<p>
If <code>w</code> is of type <code>"mask"</code> then the 
pixel closest to <code>(x[i],y[i])</code> is tested. The
results may be incorrect for points lying within 
one pixel diameter of the window boundary.
</p>


<h3>Value</h3>

<p>
Logical vector whose <code>i</code>th entry is 
<code>TRUE</code> if the corresponding point <code>(x[i],y[i])</code>
is inside <code>w</code>.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="owin.object.html">owin.object</a></code>,
<code><a href="as.owin.html">as.owin</a></code>
</p>


<h3>Examples</h3>

<pre>
  # hexagonal window
  k &lt;- 6
  theta &lt;- 2 * pi * (0:(k-1))/k
  co &lt;- cos(theta)
  si &lt;- sin(theta)
  mas &lt;- owin(c(-1,1), c(-1,1), poly=list(x=co, y=si))
  ## Not run: 
  plot(mas)
  
## End(Not run)

  # random points in rectangle
  x &lt;- runif(30,min=-1, max=1)
  y &lt;- runif(30,min=-1, max=1)

  ok &lt;- inside.owin(x, y, mas)

  ## Not run: 
  points(x[ok], y[ok])
  points(x[!ok], y[!ok], pch="x")
  
## End(Not run)  
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
