<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: K-function</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for Kest {spatstat}"><tr><td>Kest {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>K-function</h2>


<h3>Description</h3>

<p>
Estimates the reduced second moment function <i>K(r)</i> 
from a point pattern in a window of arbitrary shape.
</p>


<h3>Usage</h3>

<pre>
  Kest(X, ..., r=NULL, breaks=NULL, 
     correction=c("border", "isotropic", "Ripley", "translate"),
    nlarge=3000)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
The observed point pattern, 
from which an estimate of <i>K(r)</i> will be computed.
An object of class <code>"ppp"</code>, or data
in any format acceptable to <code><a href="as.ppp.html">as.ppp</a>()</code>.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Ignored.</td></tr>
<tr valign="top"><td><code>r</code></td>
<td>
Optional. Vector of values for the argument <i>r</i> at which <i>K(r)</i> 
should be evaluated. There is a sensible default.
</td></tr>
<tr valign="top"><td><code>breaks</code></td>
<td>
Optional. An alternative to the argument <code>r</code>.
Not normally invoked by the user. See the <B>Details</B> section.
</td></tr>
<tr valign="top"><td><code>correction</code></td>
<td>
Optional. A character vector containing any selection of the
options <code>"border"</code>, <code>"bord.modif"</code>,
<code>"isotropic"</code>, <code>"Ripley"</code> or <code>"translate"</code>.
It specifies the edge correction(s) to be applied.
</td></tr>
<tr valign="top"><td><code>nlarge</code></td>
<td>
Optional. Efficiency threshold.
If the number of points exceeds <code>nlarge</code>, then only the
border correction will be computed, using a fast algorithm.
</td></tr>
</table>

<h3>Details</h3>

<p>
The <i>K</i> function (variously called ``Ripley's K-function''
and the ``reduced second moment function'')
of a stationary point process <i>X</i> is defined so that
<i>lambda K(r)</i> equals the expected number of
additional random points within a distance <i>r</i> of a
typical random point of <i>X</i>. Here <i>lambda</i>
is the intensity of the process,
i.e. the expected number of points of <i>X</i> per unit area.
The <i>K</i> function is determined by the 
second order moment properties of <i>X</i>.
</p>
<p>
An estimate of <i>K</i> derived from a spatial point pattern dataset
can be used in exploratory data analysis and formal inference
about the pattern (Cressie, 1991; Diggle, 1983; Ripley, 1988).
In exploratory analyses, the estimate of <i>K</i> is a useful statistic 
summarising aspects of inter-point ``dependence'' and ``clustering''.
For inferential purposes, the estimate of <i>K</i> is usually compared to the 
true value of <i>K</i> for a completely random (Poisson) point process,
which is <i>K(r) = pi * r^2</i>.
Deviations between the empirical and theoretical <i>K</i> curves
may suggest spatial clustering or spatial regularity.
</p>
<p>
This routine <code>Kest</code> estimates the <i>K</i> function
of a stationary point process, given observation of the process
inside a known, bounded window. 
The argument <code>X</code> is interpreted as a point pattern object 
(of class <code>"ppp"</code>, see <code><a href="ppp.object.html">ppp.object</a></code>) and can
be supplied in any of the formats recognised by
<code><a href="as.ppp.html">as.ppp</a>()</code>.
</p>
<p>
The estimation of <i>K</i> is hampered by edge effects arising from 
the unobservability of points of the random pattern outside the window. 
An edge correction is needed to reduce bias (Baddeley, 1998; Ripley, 1988). 
The corrections implemented here are
<dl>
<dt>border</dt><dd>the border method or
``reduced sample'' estimator (see Ripley, 1988). This is
the least efficient (statistically) and the fastest to compute.
It can be computed for a window of arbitrary shape.
</dd>
<dt>isotropic/Ripley</dt><dd>Ripley's isotropic correction
(see Ripley, 1988; Ohser, 1983).
This is implemented for rectangular and polygonal windows
(not for binary masks).
</dd>
<dt>translate</dt><dd>Translation correction (Ohser, 1983).
Implemented for all window geometries, but slow for
complex windows. 
</dd>
</dl>
<p>
Note that the estimator assumes the process is stationary (spatially
homogeneous). For inhomogeneous point patterns, see
<code><a href="Kinhom.html">Kinhom</a></code>.
</p>
<p>
If the point pattern <code>X</code> contains more than about 3000 points,
the isotropic and translation edge corrections can be computationally
prohibitive. The computations for the border method are much faster,
and are statistically efficient when there are large numbers of
points. Accordingly, if the number of points in <code>X</code> exceeds
the threshold <code>nlarge</code>, then only the border correction will be
computed. Setting <code>nlarge=Inf</code> will prevent this from happening.
Setting <code>nlarge=0</code> is equivalent to selecting only the border
correction with <code>correction="border"</code>.
</p>
<p>
The estimator <code>Kest</code> ignores marks.
Its counterparts for multitype point patterns
are <code><a href="Kcross.html">Kcross</a></code>, <code><a href="Kdot.html">Kdot</a></code>,
and for general marked point patterns
see <code><a href="Kmulti.html">Kmulti</a></code>. 
</p>
<p>
Some writers, particularly Stoyan (1994, 1995) advocate the use of
the ``pair correlation function''
</p><p align="center"><i>g(r) = K'(r)/ ( 2 * pi * r) 
</i></p><p>
where <i>K'(r)</i> is the derivative of <i>K(r)</i>.
See <code><a href="pcf.html">pcf</a></code> on how to estimate this function.
</p>


<h3>Value</h3>

<p>
An object of class <code>"fv"</code>, see <code><a href="fv.object.html">fv.object</a></code>,
which can be plotted directly using <code><a href="plot.fv.html">plot.fv</a></code>.
<br>
Essentially a data frame containing columns
</p>
<table summary="R argblock">
<tr valign="top"><td><code>r</code></td>
<td>
the vector of values of the argument <i>r</i> 
at which the function <i>K</i> has been  estimated
</td></tr>
<tr valign="top"><td><code>theo</code></td>
<td>
the theoretical value <i>K(r) = pi * r^2</i>
for a stationary Poisson process
</td></tr>
</table>
<p>

together with columns named 
<code>"border"</code>, <code>"bord.modif"</code>,
<code>"iso"</code> and/or <code>"trans"</code>,
according to the selected edge corrections. These columns contain
estimates of the function <i>K(r)</i> obtained by the edge corrections
named.</p>

<h3>Warnings</h3>

<p>
The estimator of <i>K(r)</i> is approximately unbiased for each fixed <i>r</i>.
Bias increases with <i>r</i> and depends on the window geometry.
For a rectangular window it is prudent to restrict the <i>r</i> values to
a maximum of <i>1/4</i> of the smaller side length of the rectangle.
Bias may become appreciable for point patterns consisting of 
fewer than 15 points.
</p>
<p>
While <i>K(r)</i> is always a non-decreasing function, the estimator 
of <i>K</i> is not guaranteed to be non-decreasing. This is rarely 
a problem in practice.
</p>


<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Baddeley, A.J. Spatial sampling and censoring.
In O.E. Barndorff-Nielsen, W.S. Kendall and
M.N.M. van Lieshout (eds) 
<EM>Stochastic Geometry: Likelihood and Computation</EM>.
Chapman and Hall, 1998.
Chapter 2, pages 37&ndash;78.
</p>
<p>
Cressie, N.A.C. <EM>Statistics for spatial data</EM>.
John Wiley and Sons, 1991.
</p>
<p>
Diggle, P.J. <EM>Statistical analysis of spatial point patterns</EM>.
Academic Press, 1983.
</p>
<p>
Ohser, J. (1983)
On estimators for the reduced second moment measure of
point processes. <EM>Mathematische Operationsforschung und
Statistik, series Statistics</EM>, <B>14</B>, 63 &ndash; 71.
</p>
<p>
Ripley, B.D. <EM>Statistical inference for spatial processes</EM>.
Cambridge University Press, 1988.
</p>
<p>
Stoyan, D, Kendall, W.S. and Mecke, J. (1995)
<EM>Stochastic geometry and its applications</EM>.
2nd edition. Springer Verlag.
</p>
<p>
Stoyan, D. and Stoyan, H. (1994)
Fractals, random shapes and point fields:
methods of geometrical statistics.
John Wiley and Sons.
</p>


<h3>See Also</h3>

<p>
<code><a href="Fest.html">Fest</a></code>,
<code><a href="Gest.html">Gest</a></code>,
<code><a href="Jest.html">Jest</a></code>,
<code><a href="pcf.html">pcf</a></code>,
<code><a href="reduced.sample.html">reduced.sample</a></code>,
<code><a href="Kcross.html">Kcross</a></code>,
<code><a href="Kdot.html">Kdot</a></code>,
<code><a href="Kinhom.html">Kinhom</a></code>,
<code><a href="Kmulti.html">Kmulti</a></code>
</p>


<h3>Examples</h3>

<pre>
 pp &lt;- runifpoint(50)
 K &lt;- Kest(pp)
 data(cells)
 K &lt;- Kest(cells, correction="isotropic")
 plot(K)
 plot(K, main="K function for cells")
 # plot the L function
 plot(K, sqrt(iso/pi) ~ r)
 plot(K, sqrt(./pi) ~ r, ylab="L(r)", main="L function for cells")
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
