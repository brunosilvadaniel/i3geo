<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>R: Residuals for Fitted Point Process Model</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for residuals.ppm {spatstat}"><tr><td>residuals.ppm {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Residuals for Fitted Point Process Model</h2>


<h3>Description</h3>

<p>
Given a point process model fitted to a point pattern,
compute residuals.
</p>


<h3>Usage</h3>

<pre>
  ## S3 method for class 'ppm':
  residuals(object, type="raw", ..., check=TRUE,
                fittedvalues=fitted.ppm(object, check=check))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
The fitted point process model (an object of class <code>"ppm"</code>)
for which residuals should be calculated.
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
String indicating the type of residuals to be calculated.
Current options are
<code>"raw"</code>, <code>"inverse"</code> and <code>"pearson"</code>.
A partial match is adequate.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
Ignored.
</td></tr>
<tr valign="top"><td><code>check</code></td>
<td>
Logical value indicating whether to check the internal format
of <code>object</code>. If there is any possibility that this object
has been restored from a dump file, or has otherwise lost track of
the environment where it was originally computed, set
<code>check=TRUE</code>. 
</td></tr>
<tr valign="top"><td><code>fittedvalues</code></td>
<td>
Vector of fitted values for the conditional intensity at 
the quadrature points,
from which the residuals will be computed. 
For expert use only.
</td></tr>
</table>

<h3>Details</h3>

<p>
This function computes several kinds of residuals for the fit of
a point process model to a spatial point pattern dataset
(Baddeley et al, 2005).
Use <code><a href="diagnose.ppm.html">diagnose.ppm</a></code> to produce diagnostic plots
based on these residuals.
</p>
<p>
The argument <code>object</code> must be a fitted point process model
(object of class <code>"ppm"</code>). Such objects are produced by the maximum
pseudolikelihood fitting algorithm <code><a href="ppm.html">ppm</a></code>).
This fitted model object contains complete
information about the original data pattern. 
</p>
<p>
Residuals are attached both to the data points and to some
other points in the window of observation (namely, to the dummy
points of the quadrature scheme used to fit the model).
If the fitted model is correct, then the sum of the 
residuals over all (data and dummy) points in a spatial region <i>B</i>
has mean zero. For further explanation, see Baddeley et al (2005).
</p>
<p>
The type of residual
is chosen by the argument <code>type</code>. Current options are
</p>

<dl>
<dt><code>"raw"</code>:</dt><dd>the raw residuals
</p><p align="center"><i>r[j] = z[j] - w[j] lambda[j]
</i></p><p>
at the quadrature points <i>u[j]</i>,
where <i>z[j]</i> is the indicator equal to 1 if <i>u[j]</i>
is a data point and 0 if <i>u[j]</i> is a dummy point;
<i>w[j]</i> is the quadrature weight attached to
<i>u[j]</i>; and
</p><p align="center"><i>lambda[j] = lambda(u[j],x)</i></p><p>
is the conditional intensity of the fitted model at <i>u[j]</i>.
These are the spatial analogue of the martingale residuals
of a one-dimensional counting process.
</dd>
<dt><code>"inverse"</code>:</dt><dd>the `inverse-lambda' residuals (Baddeley et al, 2005)
</p><p align="center"><i>rI[j] = r[j]/lambda[j] = z[j]/lambda[j] - w[j]
</i></p><p>
obtained by dividing the raw residuals by 
the fitted conditional intensity. These are 
a counterpart of the exponential energy marks (see <code><a href="eem.html">eem</a></code>).
</dd>
<dt><code>"pearson"</code>:</dt><dd>the Pearson residuals (Baddeley et al, 2005)
</p><p align="center"><i>rP[j] = r[j]/sqrt(lambda[j])
= z[j]/sqrt(lambda[j]) - w[j] sqrt(lambda[j])
</i></p><p>
obtained by dividing the raw residuals by the
square root of the fitted conditional intensity.
The Pearson residuals are standardised, in the sense
that if the model (true and fitted) is Poisson,
then the sum of the Pearson residuals in a spatial region <i>B</i>
has variance equal to the area of <i>B</i>.
</dd>
</dl>

<p>
Use <code><a href="diagnose.ppm.html">diagnose.ppm</a></code> to produce diagnostic plots
based on these residuals.
</p>


<h3>Value</h3>

<p>
A vector containing the (discretised) residuals.
<br>
Entries in this vector correspond to the quadrature points (data or
dummy points) used to fit the model. The quadrature points can be
extracted from <code>object</code> by <code>union.quad(quad.ppm(object))</code>.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Baddeley, A., Turner, R., Moller, J. and Hazelton, M. (2005)
Residual analysis for spatial point processes.
<EM>Journal of the Royal Statistical Society, Series B</EM>
<B>67</B>, 617&ndash;666.
</p>


<h3>See Also</h3>

<p>
<code><a href="diagnose.ppm.html">diagnose.ppm</a></code>,
<code><a href="ppm.object.html">ppm.object</a></code>,
<code><a href="ppm.html">ppm</a></code>
</p>


<h3>Examples</h3>

<pre>
    data(cells)
    fit &lt;- ppm(cells, ~x, Strauss(r=0.15), rbord=0.15)

    rp &lt;- residuals.ppm(fit, type="pe")
    sum(rp) # should be close to 0

    # extract quadrature points to which the residuals correspond
    quadpoints &lt;- union.quad(quad.ppm(fit))

    # plot residuals as marks attached to the quadrature points 
    quadmarked &lt;- setmarks(quadpoints, rp)
    plot(quadmarked)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
