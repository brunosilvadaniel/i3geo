<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Set Control Parameters for Metropolis-Hastings Algorithm.</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for rmhcontrol {spatstat}"><tr><td>rmhcontrol {spatstat}</td><td align="right">R Documentation</td></tr></table>
<h2>Set Control Parameters for Metropolis-Hastings Algorithm.</h2>


<h3>Description</h3>

<p>
Sets up a list of parameters controlling the iterative behaviour
of the Metropolis-Hastings algorithm.
</p>


<h3>Usage</h3>

<pre>
   rmhcontrol(control, ...)
   ## Default S3 method:
   rmhcontrol(control=NULL, ..., p=0.9, q=0.5, nrep=5e5,
                      expand=NULL, periodic=FALSE, ptypes=NULL,
                      fixall=FALSE, nverb=0)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>control</code></td>
<td>
An existing list of control parameters
in some other format. Incompatible with the arguments listed below.
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
There should be no other arguments.</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
Probability of proposing a shift (as against a birth/death)</td></tr>
<tr valign="top"><td><code>q</code></td>
<td>
Conditional probability of proposing a death given that a
birth or death will be proposed</td></tr>
<tr valign="top"><td><code>nrep</code></td>
<td>
Total number of steps (proposals) of Metropolis-Hastings
algorithm that should be run</td></tr>
<tr valign="top"><td><code>expand</code></td>
<td>
Either a numerical expansion factor,
or a window (object of class <code>"owin"</code>), specifying that
simulations are to be performed in a domain larger than the
original data window, then clipped to the original data window.
</td></tr>
<tr valign="top"><td><code>periodic</code></td>
<td>
(Logical) whether to simulate ``periodically'', i.e.
on a torus formed by identifying opposite edges of a rectangle.</td></tr>
<tr valign="top"><td><code>ptypes</code></td>
<td>
For multitype point processes, the distribution of
the mark attached to a new random point (when a birth is
proposed)</td></tr>
<tr valign="top"><td><code>fixall</code></td>
<td>
(Logical) for multitype point processes,
whether to fix the number of points of each type.</td></tr>
<tr valign="top"><td><code>nverb</code></td>
<td>
Progress reports will be printed every <code>nverb</code>
iterations</td></tr>
</table>

<h3>Details</h3>

<p>
The Metropolis-Hastings algorithm, implemented as <code><a href="rmh.html">rmh</a></code>,
generates simulated realisations of point process models.
This function <code>rmhcontrol</code>
sets up a list of parameters which control the 
iterative behaviour
and termination of the Metropolis-Hastings algorithm, for use in a
subsequent call to <code><a href="rmh.html">rmh</a></code>. It also checks that the
parameters are valid.
</p>
<p>
(A separate function <code><a href="rmhstart.html">rmhstart</a></code>
determines the initial state of the algorithm,
and <code><a href="rmhmodel.html">rmhmodel</a></code> determines the model to be simulated.)
</p>
<p>
The algorithm control parameters should be specified <B>either</B> by the
first argument <code>control</code> <B>or</B> by the other arguments
<code>p</code>, <code>q</code> etc.
</p>
<p>
If <code>control</code> is specified, it may be a list of parameter values
(with components named <code>p</code>, <code>q</code> etc,
having the same interpretation as described below)
or an object of class <code>"rmhcontrol"</code> obtained by a previous
call to <code>rmhcontrol</code>.
</p>
<p>
The parameters are as follows:
</p>

<dl>
<dt>p</dt><dd>The probability of proposing a ``shift''
(as opposed to a birth or death) in the Metropolis-Hastings
algorithm.
</p>
<p>
If <i>p = 1</i> then the algorithm only alters existing points,
so the number of points never changes, i.e. we are
simulating conditionally upon the number of points.
The number of points is determined by the initial state
(specified by <code><a href="rmhstart.html">rmhstart</a></code>).
</p>
<p>
If <i>p=1</i> and <code>fixall=TRUE</code> and the model
is a multitype point process model, then the algorithm
only shifts the locations of existing points and does not
alter their marks (types). 
This is equivalent to simulating conditionally
upon the number of points of each type.
These numbers are again specified by the initial state.
</p>
<p>
If <i>p = 1</i> then no expansion of the simulation window
is allowed (see <code>expand</code> below).
</dd>
<dt>q</dt><dd>The conditional probability of proposing a death
(rather than a birth) given that a shift is not proposed.
This is of course ignored if <code>p</code> is equal to 1.
</dd>
<dt>nrep</dt><dd>The number of repetitions or iterations 
to be made by the Metropolis-Hastings algorithm.  It should
be large.
</dd>
<dt>expand</dt><dd>Either a numerical expansion factor, or
a window (object of class <code>"owin"</code>). Indicates that
the process is to be simulated on a larger domain than the
original data window <code>w</code>, then clipped to <code>w</code>
when the algorithm has finished.
This would often be done in order to approximate the
simulation of a stationary process (Geyer, 1999)
or more generally a process existing in the
whole plane, rather than just in the window <code>w</code>.
</p>
<p>
If <code>expand</code> is a window object, it is taken as the
larger domain in which simulation is performed.
If <code>expand</code> is numeric, it is interpreted
as the factor by which the <EM>area</EM> of the enclosing box of the
window <code>w</code> is to be expanded (i.e. width and height are
stretched by the same factor <code>sqrt(area)</code>).
The expansion is computed by the function <code><a href="expand.owin.html">expand.owin</a></code>.
</p>
<p>
If <code>expand</code> equals 1 then no expansion is performed.
Any value of <code>expand</code> smaller than 1 is ignored and
treated as 1.
</p>
<p>
Expansion is not permitted if the number of points has been
fixed by setting <code>p = 1</code> or if the
starting configuration has been specified via the
argument <code>x.start</code> in <code><a href="rmhstart.html">rmhstart</a></code>.
In these cases <code>expand</code> defaults to 1.
</p>
<p>
Otherwise, <code>expand</code> defaults to 2.
</dd>
<dt>periodic</dt><dd>A logical scalar; if <code>periodic</code> is <code>TRUE</code>
we simulate a process on the torus formed by identifying
opposite edges of a rectangular window.  This window could
be the ``original'' window if that window is rectangular, or
the bounding box of that window, or an expansion of the
bounding box (when <code>expand</code> is greater than 1).  In the
latter two cases the simulated pattern is clipped to the
original window.
</dd>
<dt>ptypes</dt><dd>A vector of probabilities (summing to 1) to be used
in assigning a random type to a new point.  Defaults to a vector
each of whose entries is <i>1/nt</i> where <i>nt</i> is the number
of types for the process.  Convergence of the simulation
algorithm should be improved if <code>ptypes</code> is close to the
relative frequencies of the types which will result from the
simulation.
</dd>
<dt>fixall</dt><dd>A logical scalar specifying whether to condition on
the number of points of each type.  Meaningful only if a marked
process is being simulated, and if <i>p = 1</i>.  A warning message
is given if <code>fixall</code> is set equal to <code>TRUE</code> when it is
not meaningful.
</dd>
<dt>nverb</dt><dd>An integer specifying how often ``progress reports''
(which consist simply of the number of repetitions completed)
should be printed out.  If nverb is left at 0, the default,
the simulation proceeds silently.
</dd>
</dl>

<h3>Value</h3>

<p>
An object of class <code>"rmhcontrol"</code>, which is essentially
a list of parameter values for the algorithm.
<br>
There is a <code>print</code> method for this class, which prints
a sensible description of the parameters chosen.</p>

<h3>Author(s)</h3>

<p>
Adrian Baddeley
<a href="mailto:adrian@maths.uwa.edu.au">adrian@maths.uwa.edu.au</a>
<a href="http://www.maths.uwa.edu.au/~adrian/">http://www.maths.uwa.edu.au/~adrian/</a>
and Rolf Turner
<a href="mailto:rolf@math.unb.ca">rolf@math.unb.ca</a>
<a href="http://www.math.unb.ca/~rolf">http://www.math.unb.ca/~rolf</a>
</p>


<h3>References</h3>

<p>
Geyer, C.J. (1999)
Likelihood Inference for Spatial Point
Processes. Chapter 3 in  O.E. Barndorff-Nielsen, W.S. Kendall and
M.N.M. Van Lieshout (eds) <EM>Stochastic Geometry: Likelihood and
Computation</EM>, Chapman and Hall / CRC,  Monographs on Statistics and
Applied Probability, number 80. Pages 79&ndash;140.
</p>


<h3>See Also</h3>

<p>
<code><a href="rmh.html">rmh</a></code>,
<code><a href="rmhmodel.html">rmhmodel</a></code>,
<code><a href="rmhstart.html">rmhstart</a></code>,
<code><a href="expand.owin.html">expand.owin</a></code>
</p>


<h3>Examples</h3>

<pre>
   # parameters given as named arguments
   c1 &lt;- rmhcontrol(p=0.3,periodic=TRUE,nrep=1e6,nverb=1e5)

   # parameters given as a list
   liz &lt;- list(p=0.9, nrep=1e4)
   c2 &lt;- rmhcontrol(liz)

   # parameters given in rmhcontrol object
   c3 &lt;- rmhcontrol(c1)
</pre>



<hr><div align="center">[Package <em>spatstat</em> version 1.10-3 <a href="00Index.html">Index]</a></div>

</body></html>
