var axis_optionsDef;def.scope(function(){def.type('pvc.visual.Axis',pvc.visual.OptionsBase).init(function(chart,type,index,keyArgs){this.base(chart,type,index,keyArgs);chart._addAxis(this)}).add({isVisible:true,scaleTreatsNullAs:function(){return'null'},scaleNullRangeValue:function(){return null},scaleUsesAbs:function(){return false},bind:function(dataCells){dataCells||def.fail.argumentRequired('dataCells');!this.dataCells||def.fail.operationInvalid('Axis is already bound.');this.dataCells=def.array.to(dataCells);this.dataCell=this.dataCells[0];this.role=this.dataCell&&this.dataCell.role;this.scaleType=groupingScaleType(this.role.grouping);this._checkRoleCompatibility();return this},isDiscrete:function(){return this.role&&this.role.isDiscrete()},isBound:function(){return!!this.role},setScale:function(scale,noWrap){this.role||def.fail.operationInvalid('Axis is unbound.');this.scale=scale?(noWrap?scale:this._wrapScale(scale)):null;return this},_wrapScale:function(scale){scale.type=this.scaleType;var by;if(scale.type!=='discrete'){var useAbs=this.scaleUsesAbs();var nullAs=this.scaleTreatsNullAs();if(nullAs&&nullAs!=='null'){var nullValue=nullAs==='min'?scale.domain()[0]:0;if(useAbs){by=function(v){return scale(v==null?nullValue:(v<0?-v:v))}}else{by=function(v){return scale(v==null?nullValue:v)}}}else{var nullRangeValue=this.scaleNullRangeValue();if(useAbs){by=function(v){return v==null?nullRangeValue:scale(v<0?-v:v)}}else{by=function(v){return v==null?nullRangeValue:scale(v)}}}}else{by=function(v){return scale(v==null?'':v)}}return def.copy(by,scale)},sceneScale:function(keyArgs){var varName=def.get(keyArgs,'sceneVarName')||this.role.name,grouping=this.role.grouping;if(grouping.isSingleDimension&&grouping.firstDimensionValueType()===Number){var scale=this.scale,nullToZero=def.get(keyArgs,'nullToZero',true);var by=function(scene){var value=scene.vars[varName].value;if(value==null){if(!nullToZero){return value}value=0}return scale(value)};def.copy(by,scale);return by}return this.scale.by1(function(scene){return scene.vars[varName].value})},_checkRoleCompatibility:function(){var L=this.dataCells.length;if(L>1){var grouping=this.role.grouping,i;if(this.scaleType==='discrete'){for(i=1;i<L;i++){if(grouping.id!==this.dataCells[i].role.grouping.id){throw def.error.operationInvalid("Discrete roles on the same axis must have equal groupings.")}}}else{if(!grouping.firstDimensionType().isComparable){throw def.error.operationInvalid("Continuous roles on the same axis must have 'comparable' groupings.")}for(i=1;i<L;i++){if(this.scaleType!==groupingScaleType(this.dataCells[i].role.grouping)){throw def.error.operationInvalid("Continuous roles on the same axis must have scales of the same type.")}}}}},_getOptionsDefinition:function(){return axis_optionsDef}});function groupingScaleType(grouping){return grouping.isDiscrete()?'discrete':(grouping.firstDimensionValueType()===Date?'timeSeries':'numeric')}axis_optionsDef={}});