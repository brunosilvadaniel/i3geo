def.type('pvc.BaseChart',pvc.Abstract).init(function(options){var originalOptions=options;var parent=this.parent=def.get(options,'parent')||null;if(parent){options||def.fail.argumentRequired('options')}else{options=def.mixin.copy({},this.defaults,options)}this.options=options;if(parent){this.root=parent.root;this.smallColIndex=options.smallColIndex;this.smallRowIndex=options.smallRowIndex;this._tooltipEnabled=parent._tooltipEnabled;this._tooltipOptions=parent._tooltipOptions}else{this.root=this}this.base();if(pvc.debug>=3){this._info("NEW CHART\n"+pvc.logSeparator.replace(/-/g,'=')+"\n  DebugLevel: "+pvc.debug)}if(pvc.debug>=3&&!parent&&originalOptions){this._info("OPTIONS:\n",originalOptions);if(pvc.debug>=5){this._trace(pvc.stringify(options,{ownOnly:false,funs:true}))}}if(parent){parent._addChild(this)}this._constructData(options);this._constructVisualRoles(options)}).add({_disposed:false,_animatable:false,parent:null,children:null,root:null,isPreRendered:false,_createVersion:0,renderCallback:undefined,multiChartPageCount:null,multiChartPageIndex:null,left:0,top:0,width:null,height:null,margins:null,paddings:null,_allowV1SecondAxis:false,compatVersion:function(options){return(options||this.options).compatVersion},_createLogInstanceId:function(){return""+this.constructor+this._createLogChildSuffix()},_createLogChildSuffix:function(){return this.parent?(" ("+(this.smallRowIndex+1)+","+(this.smallColIndex+1)+")"):""},_addChild:function(childChart){(childChart.parent===this)||def.assert("Not a child of this chart.");this.children.push(childChart)},_preRender:function(keyArgs){this._preRenderPhase1(keyArgs);this._preRenderPhase2(keyArgs)},_preRenderPhase1:function(keyArgs){this._createVersion++;this.isPreRendered=false;if(pvc.debug>=3){this._log("Prerendering")}this.children=[];if(!this.parent){pvc.removeTipsyLegends()}this._processOptions();this._checkNoDataI();if(!this.parent&&this._createVersion===1){this._initVisualRoles();this._bindVisualRolesPreI();this._complexTypeProj=this._createComplexTypeProject();this._bindVisualRolesPreII()}this._initData(keyArgs);this._checkNoDataII();var hasMultiRole=this._isRoleAssigned('multiChart');this._initPlots(hasMultiRole);this._initAxes(hasMultiRole);this._bindAxes(hasMultiRole);if(this.parent||!hasMultiRole){this._interpolate(hasMultiRole);this._generateTrends(hasMultiRole)}this._setAxesScales(hasMultiRole)},_preRenderPhase2:function(){var hasMultiRole=this._isRoleAssigned('multiChart');this._initChartPanels(hasMultiRole);this.isPreRendered=true},_setSmallLayout:function(keyArgs){if(keyArgs){var basePanel=this.basePanel;if(this._setProp('left',keyArgs)|this._setProp('top',keyArgs)){if(basePanel){def.set(basePanel.position,'left',this.left,'top',this.top)}}if(this._setProp('width',keyArgs)|this._setProp('height',keyArgs)){if(basePanel){basePanel.size=new pvc.Size(this.width,this.height)}}if(this._setProp('margins',keyArgs)&&basePanel){basePanel.margins=new pvc.Sides(this.margins)}if(this._setProp('paddings',keyArgs)&&basePanel){basePanel.paddings=new pvc.Sides(this.paddings)}}},_setProp:function(p,keyArgs){var v=keyArgs[p];if(v!=null){this[p]=v;return true}},_processOptions:function(){var options=this.options;if(parseInt(options.width,10)+"%"==options.width){try{var viewportwidth,viewportheight,wdiv,r,scr=null,inn=null,wNoScroll=0,wScroll=0;if(typeof window.innerWidth!='undefined'){viewportwidth=window.innerWidth,viewportheight=window.innerHeight}else if(typeof document.documentElement!='undefined'&&typeof document.documentElement.clientWidth!='undefined'&&document.documentElement.clientWidth!=0){viewportwidth=document.documentElement.clientWidth,viewportheight=document.documentElement.clientHeight}else{viewportwidth=document.getElementsByTagName('body')[0].clientWidth,viewportheight=document.getElementsByTagName('body')[0].clientHeight}scr=document.createElement('div');scr.style.position='absolute';scr.style.top='-1000px';scr.style.left='-1000px';scr.style.width='100px';scr.style.height='50px';scr.style.overflow='hidden';inn=document.createElement('div');inn.style.width='100%';inn.style.height='200px';scr.appendChild(inn);document.body.appendChild(scr);wNoScroll=inn.offsetWidth;scr.style.overflow='auto';wScroll=inn.offsetWidth;document.body.removeChild(document.body.lastChild);viewportwidth=viewportwidth-wNoScroll-wScroll;r=(parseInt(options.width,10)/100)*viewportwidth;options.width=parseInt(r,10)}catch(e){options.width=parseInt(options.width,10)}}if(!this.parent){this.width=options.width;this.height=options.height;this.margins=options.margins;this.paddings=options.paddings}if(this.compatVersion()<=1){options.plot2=this._allowV1SecondAxis&&!!options.secondAxis}this._processOptionsCore(options);this._processExtensionPoints();return options},_processOptionsCore:function(options){if(!this.parent){if(!$.support.svg||pv.renderer()==='batik'){options.animate=false}this._processTooltipOptions(options)}},_tooltipDefaults:{gravity:'s',delayIn:200,delayOut:80,offset:2,opacity:0.9,html:true,fade:true,useCorners:false,arrowVisible:true,followMouse:false,format:undefined},_processTooltipOptions:function(options){var isV1Compat=this.compatVersion()<=1;var tipOptions=options.tooltip;var tipEnabled=options.tooltipEnabled;if(tipEnabled==null){if(tipOptions){tipEnabled=tipOptions.enabled}if(tipEnabled==null){if(isV1Compat){tipEnabled=options.showTooltips}if(tipEnabled==null){tipEnabled=true}}}if(tipEnabled){if(!tipOptions){tipOptions={}}if(isV1Compat){this._importV1TooltipOptions(tipOptions,options)}def.eachOwn(this._tooltipDefaults,function(dv,p){var value=options['tooltip'+def.firstUpperCase(p)];if(value!==undefined){tipOptions[p]=value}else if(tipOptions[p]===undefined){tipOptions[p]=dv}})}else{tipOptions={}}this._tooltipEnabled=tipEnabled;this._tooltipOptions=tipOptions},_importV1TooltipOptions:function(tipOptions,options){var v1TipOptions=options.tipsySettings;if(v1TipOptions){this.extend(v1TipOptions,"tooltip");for(var p in v1TipOptions){if(tipOptions[p]===undefined){tipOptions[p]=v1TipOptions[p]}}if(tipOptions.html==null){tipOptions.html=false}}},render:function(bypassAnimation,recreate,reloadData){var hasError;if(pvc.debug>1){pvc.group("CCC RENDER")}this._suspendSelectionUpdate();try{this.useTextMeasureCache(function(){try{if(!this.isPreRendered||recreate){this._preRender({reloadData:reloadData})}else if(!this.parent&&this.isPreRendered){pvc.removeTipsyLegends()}this.basePanel.render({bypassAnimation:bypassAnimation,recreate:recreate})}catch(e){if(e instanceof NoDataException){if(pvc.debug>1){this._log("No data found.")}this._addErrorPanelMessage("No data found",true)}else{hasError=true;pvc.logError(e.message);if(pvc.debug>0){this._addErrorPanelMessage("Error: "+e.message,false)}}}})}finally{if(!hasError){this._resumeSelectionUpdate()}if(pvc.debug>1){pvc.groupEnd()}}return this},_addErrorPanelMessage:function(text,isNoData){var options=this.options,pvPanel=new pv.Panel().canvas(options.canvas).width(this.width).height(this.height),pvMsg=pvPanel.anchor("center").add(pv.Label).text(text);if(isNoData){this.extend(pvMsg,"noDataMessage")}pvPanel.render()},useTextMeasureCache:function(fun,ctx){var root=this.root;var textMeasureCache=root._textMeasureCache||(root._textMeasureCache=pv.Text.createCache());return pv.Text.usingCache(textMeasureCache,fun,ctx||this)},animate:function(start,end){return this.basePanel.animate(start,end)},isAnimatingStart:function(){return this.basePanel.isAnimatingStart()},isOrientationVertical:function(orientation){return(orientation||this.options.orientation)===pvc.orientation.vertical},isOrientationHorizontal:function(orientation){return(orientation||this.options.orientation)===pvc.orientation.horizontal},dispose:function(){if(!this._disposed){this._disposed=true}},defaults:{width:400,height:300,orientation:'vertical',ignoreNulls:true,crosstabMode:true,isMultiValued:false,seriesInRows:false,groupedLabelSep:undefined,animate:true,titlePosition:"top",titleAlign:"center",legend:false,legendPosition:"bottom",v1StyleTooltipFormat:function(s,c,v,datum){return s+", "+c+":  "+this.chart.options.valueFormat(v)+(datum&&datum.percent?(" ("+datum.percent.label+")"):"")},valueFormat:def.scope(function(){var pvFormat=pv.Format.number().fractionDigits(0,2);return function(d){return pvFormat.format(d)}}),percentValueFormat:def.scope(function(){var pvFormat=pv.Format.number().fractionDigits(0,1);return function(d){return pvFormat.format(d*100)+"%"}}),clickable:false,doubleClickMaxDelay:300,hoverable:false,selectable:false,selectionMode:'rubberband',ctrlSelectMode:true,clearSelectionMode:'emptySpaceClick',compatVersion:Infinity}});