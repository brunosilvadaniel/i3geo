pvc.BaseChart.add({basePanel:null,titlePanel:null,legendPanel:null,_multiChartPanel:null,_initChartPanels:function(hasMultiRole){this._initBasePanel();this._initTitlePanel();var legendPanel=this._initLegendPanel();if(!this.parent&&hasMultiRole){this._initMultiChartPanel();if(legendPanel){this._initLegendScenes(legendPanel)}}else{var options=this.options;if(legendPanel){this._initLegendScenes(legendPanel)}this._preRenderContent({margins:hasMultiRole?options.smallContentMargins:options.contentMargins,paddings:hasMultiRole?options.smallContentPaddings:options.contentPaddings,clickAction:options.clickAction,doubleClickAction:options.doubleClickAction})}},_preRenderContent:function(contentOptions){},_initBasePanel:function(){var options=this.options;var basePanelParent=this.parent&&this.parent._multiChartPanel;this.basePanel=new pvc.BasePanel(this,basePanelParent,{margins:this.margins,paddings:this.paddings,size:{width:this.width,height:this.height}})},_initTitlePanel:function(){var options=this.options;if(!def.empty(options.title)){var isRoot=!this.parent;this.titlePanel=new pvc.TitlePanel(this,this.basePanel,{title:options.title,font:options.titleFont,anchor:options.titlePosition,align:options.titleAlign,alignTo:options.titleAlignTo,offset:options.titleOffset,keepInBounds:options.titleKeepInBounds,margins:options.titleMargins,paddings:options.titlePaddings,titleSize:options.titleSize,titleSizeMax:options.titleSizeMax})}},_initLegendPanel:function(){var options=this.options;if(options.legend){var legend=new pvc.visual.Legend(this,'legend',0);this.legendPanel=new pvc.LegendPanel(this,this.basePanel,{anchor:legend.option('Position'),align:legend.option('Align'),alignTo:options.legendAlignTo,offset:options.legendOffset,keepInBounds:options.legendKeepInBounds,size:legend.option('Size'),sizeMax:legend.option('SizeMax'),margins:legend.option('Margins'),paddings:legend.option('Paddings'),font:legend.option('Font'),scenes:def.getPath(options,'legend.scenes'),textMargin:options.legendTextMargin,itemPadding:options.legendItemPadding,markerSize:options.legendMarkerSize});return this.legendPanel}},_getLegendBulletRootScene:function(){return this.legendPanel&&this.legendPanel._getBulletRootScene()},_initMultiChartPanel:function(){var basePanel=this.basePanel;var options=this.options;this._multiChartPanel=new pvc.MultiChartPanel(this,basePanel,{margins:options.contentMargins,paddings:options.contentPaddings});this._multiChartPanel.createSmallCharts();basePanel._children.unshift(basePanel._children.pop())},_coordinateSmallChartsLayout:function(scopesByType){},_initLegendScenes:function(legendPanel){var rootScene,dataPartDimName;var legendIndex=0;var colorAxes=this.axesByType.color;if(colorAxes){colorAxes.forEach(processAxis,this)}function processAxis(colorAxis){if(colorAxis.option('LegendVisible')){var dataCells=colorAxis&&colorAxis.dataCells;if(dataCells){dataCells.forEach(function(dataCell){if(dataCell.role.isDiscrete()){var domainData=dataCell.data;if(!rootScene){dataPartDimName=this._getDataPartDimName();rootScene=legendPanel._getBulletRootScene()}var dataPartAtom;var locked=colorAxis.option('LegendClickMode')==='toggleVisible'&&(dataPartAtom=domainData.atoms[dataPartDimName])&&dataPartAtom.value==='trend';var groupScene=rootScene.createGroup({group:domainData,colorAxis:colorAxis,clickMode:locked?'none':undefined,extensionPrefix:pvc.buildIndexedId('',legendIndex++)});dataCell.legendBulletGroupScene=groupScene;var partColorScale=colorAxis.scale;domainData.children().each(function(itemData){var itemScene=groupScene.createItem({group:itemData});itemScene.color=partColorScale(itemData.value)})}},this)}}}}});